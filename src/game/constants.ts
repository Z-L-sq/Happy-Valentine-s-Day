/**
 * æ¸¸æˆå¸¸é‡ â€” åœ°å›¾ / ç¢°æ’ / äº’åŠ¨
 *
 * åŸºäº final.tmx (36Ã—23 tiles@16px) ç²¾ç¡®åˆ†æçš„é€æ ¼å¯è¡Œèµ°åœ°å›¾ã€‚
 * ç©å®¶åªèƒ½åœ¨æœ¨åœ°æ¿ã€ç –åœ°æ¿ã€åœ°æ¯¯ä¸Šè¡Œèµ°ã€‚
 */

// ==================== åŸºç¡€å°ºå¯¸ ====================
export const SRC_TILE = 16;                          // ç²¾çµå›¾åŸå§‹ tile å°ºå¯¸
export const TILE_SIZE = 32;                          // æ¸¸æˆä¸­æ¯æ ¼åƒç´  (2Ã— ç¼©æ”¾)
export const MAP_COLS = 36;                           // åœ°å›¾åˆ—æ•°
export const MAP_ROWS = 23;                           // åœ°å›¾è¡Œæ•°
export const CANVAS_WIDTH = MAP_COLS * TILE_SIZE;     // 1152
export const CANVAS_HEIGHT = MAP_ROWS * TILE_SIZE;    // 736

// ==================== è§’è‰² ====================
export const PLAYER_SIZE = 28;
export const PLAYER_SPEED = 1.5;
export const PLAYER_START_X = 3 * TILE_SIZE;          // col 3
export const PLAYER_START_Y = 14 * TILE_SIZE;         // row 14 (walkable floor)
export const INTERACTION_DISTANCE = 48;               // ç‰©ä½“è¾¹ç¼˜ 1.5 æ ¼å†…å¯äº’åŠ¨

// ==================== æ–¹å‘ ====================
export enum Direction {
  DOWN = 0,
  LEFT = 1,
  RIGHT = 2,
  UP = 3,
}

// ==================== é€æ ¼å¯è¡Œèµ°åœ°å›¾ (36Ã—23) ====================
// ç›´æ¥ä» TMX "walk" å›¾å±‚è§£æ: 1 = å¯è¡Œèµ°, 0 = ä¸å¯è¡Œèµ°
export const WALKABLE_MAP: number[][] = [
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 0
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 1
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 2
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 3
  [0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 4
  [0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0], // row 5
  [0,0,0,0,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0], // row 6
  [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0], // row 7
  [0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0], // row 8
  [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 9
  [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 10
  [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 11
  [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], // row 12
  [0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0], // row 13
  [0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0], // row 14
  [0,0,1,1,0,0,0,0,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0,1,1,1,1,0,1,0,1,1,1,0,0,0], // row 15
  [0,0,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0], // row 16
  [0,0,0,1,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0], // row 17
  [0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0,0,0,0,1,0,0,0], // row 18
  [0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,1,0,0,0], // row 19
  [0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0], // row 20
  [0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0], // row 21
  [0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0], // row 22
];

// ==================== å¯äº’åŠ¨ç‰©ä½“ ====================
export type InteractableType = 'book' | 'letter' | 'calendar' | 'video' | 'gift' | 'photo' | 'map' | 'table';

export interface InteractableObject {
  id: string;
  type: InteractableType;
  /** äº’åŠ¨è§¦å‘åŒºåŸŸå·¦ä¸Šè§’æ ¼å­åæ ‡ */
  x: number;
  y: number;
  width: number;
  height: number;
  label: string;
  emoji: string;
}

/**
 * äº’åŠ¨è§¦å‘åŒºåŸŸ â€” ç›´æ¥æ¥è‡ª TMX å„äº’åŠ¨å›¾å±‚çš„ tile è¦†ç›–èŒƒå›´ã€‚
 * x/y/w/h è¡¨ç¤ºç©å®¶éœ€è¦è¿›å…¥çš„è§¦å‘åŒºåŸŸï¼ˆä¸æ˜¯ç‰©ä½“è§†è§‰ä½ç½®ï¼‰ã€‚
 *
 * TMX å›¾å±‚ â†’ äº’åŠ¨ç±»å‹:
 *   pic1   â†’ photo (4,14  2Ã—1)   â€” å·¦æˆ¿é—´ç›¸æ¡†
 *   pic2   â†’ photo (23,13 3Ã—2)  â€” å³æˆ¿é—´ç›¸æ¡†
 *   pic3   â†’ photo (31,14 3Ã—1)  â€” å³æˆ¿é—´ç›¸æ¡†
 *   pic4   â†’ photo (19,4  2Ã—1)  â€” ä¸­é—´å¢™ä¸Šç”»æ¡†
 *   book   â†’ book  (24,5  2Ã—1)  â€” å³ä¾§ä¹¦æ¶
 *   cal    â†’ calendar (23,19 5Ã—3) â€” å³æˆ¿é—´æ—¥å†
 *   TV     â†’ video (16,14 3Ã—1)  â€” ç”µè§†
 *   map    â†’ map   (16,15 3Ã—2)  â€” ç”µè§†æŸœåœ°å›¾
 *   letter â†’ letter (7,14 2Ã—3)  â€” ä¿¡ä»¶
 *   gift1  â†’ gift  (3,7   1Ã—1)  â€” ç¤¼ç‰©
 */
export const INTERACTABLES: InteractableObject[] = [
  // ===== ç›¸æ¡† (photo) =====
  {
    id: 'photo1',
    type: 'photo',
    x: 4, y: 14,
    width: 2, height: 1,
    label: 'å¢™ä¸Šçš„ç›¸æ¡†',
    emoji: 'ğŸ–¼ï¸',
  },
  {
    id: 'photo2',
    type: 'photo',
    x: 23, y: 13,
    width: 3, height: 2,
    label: 'å¢™ä¸Šçš„ç›¸æ¡†',
    emoji: 'ğŸ–¼ï¸',
  },
  {
    id: 'photo3',
    type: 'photo',
    x: 31, y: 14,
    width: 3, height: 1,
    label: 'å¢™ä¸Šçš„ç›¸æ¡†',
    emoji: 'ğŸ–¼ï¸',
  },
  {
    id: 'photo4',
    type: 'photo',
    x: 19, y: 4,
    width: 2, height: 1,
    label: 'ç…§ç‰‡å¢™',
    emoji: 'ğŸ–¼ï¸',
  },

  // ===== ä¹¦ (book) =====
  {
    id: 'book1',
    type: 'book',
    x: 24, y: 5,
    width: 2, height: 1,
    label: 'ä¹¦æ¶',
    emoji: 'ğŸ“š',
  },

  // ===== æ—¥å† (calendar) =====
  {
    id: 'calendar',
    type: 'calendar',
    x: 23, y: 19,
    width: 5, height: 3,
    label: 'æ—¥å†',
    emoji: 'ğŸ“…',
  },

  // ===== è§†é¢‘ (video) =====
  {
    id: 'video',
    type: 'video',
    x: 16, y: 14,
    width: 3, height: 1,
    label: 'ç”µè§†',
    emoji: 'ğŸ“º',
  },

  // ===== åœ°å›¾ (map) =====
  {
    id: 'map',
    type: 'map',
    x: 16, y: 15,
    width: 3, height: 2,
    label: 'åœ°å›¾',
    emoji: 'ğŸ—ºï¸',
  },

  // ===== ä¿¡ (letter) =====
  {
    id: 'letter',
    type: 'letter',
    x: 7, y: 14,
    width: 2, height: 3,
    label: 'æ¡Œä¸Šçš„ä¿¡å°',
    emoji: 'ğŸ’Œ',
  },

  // ===== ç¤¼ç‰© (gift) =====
  {
    id: 'gift',
    type: 'gift',
    x: 3, y: 7,
    width: 1, height: 1,
    label: 'ç¤¼ç‰©ç›’',
    emoji: 'ğŸ',
  },

  // ===== æ¢³å¦†å° (table) =====
  {
    id: 'table',
    type: 'table',
    x: 32, y: 19,
    width: 1, height: 2,
    label: 'æ¢³å¦†å°',
    emoji: 'ğŸ’„',
  },
];
